
## 基础架构
优护家架构图如下所示：
![](https://raw.githubusercontent.com/Youhujia/docs/master/backend/youhujia_helper_server_structure.png?token=AWiDLX56ZXeQ5Qbf3KQK1n9By4XkBzdDks5aAGXzwA%3D%3D)

### 商品订单架构
在优护家架构模型中，所有模型都是围绕机构-部门来设立的。整体模型支撑的前景有以下这些：

- 护士上门护理（尿管，造口）
- 护理员上门护理（洗头）
- 医院陪护（院内护理）
- 评估师上门评估 
- 护理员上门
- 销售康复护理产品。（血压计 血糖仪 只能硬件）


总体而言，业务涉及点有商品和订单。因此，商品和订单是整个数据模型的关键。

#### CRM模型

#### CMS模型

#### 商品基本模型

关系：类目 -> Item(检索出来的实体) -> ServiceItem(购买的实体）。设计的好处在于Item对象重用性

高，ServiceItem对象对于前端、客户端来说更好拿捏。

类目：5级类目，由优护家自己制定，确定之后原则上只增不改。

**Item要素**

 -  title：商品标题
 -  desc：商品描述
 -  picture：商品主图，可以多张
 -  detail：商品详情，富文本
 -  item_prop：商品属性
 -  item_prop_value：商品属性值

备：item并价格，其对外提供的价格来源于serviceItem

**ServiceItem要素**

-   price：商品价格
-   picture：商品图片

#### 商品服务发布&审核
对外提供的检索单元是商品服务，为此围绕展现的各类功能需要通过服务商品承载。

商品发布时就以商品的状态展开。

服务商品的状态有：

草稿：商品的编辑状态。

编辑完成状态：编辑完成主要是为了标识服务商品在初期的编辑状态，也方便了状态机的状态跳转。

审核中：编辑完成状态的服务商品可以提交审核，提交后进入该状态，运营人员进行审核。

审核失败：如果商品信息出现问题，则进入审核失败状态，待服务机构做更新。

待上线：审核成功后进入待上线状态，该状态下，服务机构可以随时上线，或者修改。

上线：上线状态的服务商品会被应用系统对外投放。

异常：审核人员将上线状态商品强制置为异常。

**状态机**

![](https://img.wkcontent.com/assets/migration/item_state.jpeg)

发布权限由优护家权限管理中心统一管理，参考优护家权限管理中心。

##### 标准化服务步骤模型

**数据模型见CMS模型**

如果提供内容不止简单的商品，而是服务，则不同的商品有不同的服务流程。

服务流程的设计是绑定到服务商品，而非服务单元。

整个服务流程的标准模型目前可以提供的内容包括：

宣教：相关内容介绍。

自测：下单用户的主动自评。

评估：服务人员的评估。

服务步骤设置：设计服务步骤周期。

服务步骤涉及服务项和对应的人员权限信息。具体实现由服务步骤中某项的role（角色）控制。


#### 订单模型
订单模型以订单流转为中心来设计的。核心功能包括订单流转、权限管理、日志记录、并发处理。

订单流转实现设计模式：
        
-   策略模式
-   工厂模式
-   抽象工厂模式


#### 权限模型




wget --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie" "http://download.oracle.com/otn-pub/java/jdk/8u102-b14/jdk-8u102-linux-i586.rpm"


wget --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie" "http://download.oracle.com/otn-pub/java/jdk/8u152-b16/aa0333dd3019491ca4f6ddbe78cdb6d0/jdk-8u152-linux-x64.rpm"




Constructing UsernamePasswordCredentialsProvider for URI https://github.com/Youhujia/config-repo.git

hh

