---
title: 系统稳定性提升方案
date: 2017-05-26 13:00
categories: 系统架构
tags:
- 线上运维
---

## 摘要

为泰乐城项目，需要提高系统稳定性和排错效率，提出以下改进方案

<!--more-->

## 多端问题排查解决方案

综合客户端、前端、后端排查问题的整体方案，快速定位问题。

- halo代码修正，输出调用参数。
- 其他项目 规范 call error alert， 方案已出
- logback更新，打印stack trace信息50行，其他项目需要更新logback文件与dimension相同。
- trace id 输出后边括号内，上传日志方案待定。halo
- 客户端、前端待定。

## 线上运维解决方案

### 定义级别

- alert：定义关键字。可预见性错误。 电话
	- 支付异常
	- 待讨论
- 1 min： 程序抛出异常,ERROR
- 1 week: 可通过sentry查看每周未处理问题。ERROR and WARNING

### 降级方案

- 最小系统，仅静态页面。 nginx 600.html
- 方案: 部署一个base为nginx的docker，意外发生时修改SLB的权值。

### 处理流程

对应蒲公英流程
用户报警(新建) -> 邮件反馈，已交由处理（处理中） -> 评估时间，通知用户（处理中）
-> 处理完毕、反馈用户（已解决） -> 用户反馈（已关闭）
-> 不处理&无法处理，告知原因（已关闭）

###  监控

第三方服务监控
- 采用aliyun站点监控。


采用阿里云-云监控。

- 资源监控：内存、磁盘
- 容器监控：通过网络流入流出间接监控
- 接口监控：关键服务需要接口监控
- 前端服务监控：各服务页面（站点）
