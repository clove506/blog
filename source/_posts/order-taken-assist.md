---
title: 护士上门辅助下单功能项目管理
date: 2017-3-10 21:00:00
categories: 上门护理
tags:
- 上门护理
---

## 摘要

根据跃超提供的wiki内容，对产品功能做了场景拆解。
<!--more-->

## Wiki维护人

陈晨
杨淑婷

## PM

杨淑婷

## 背景

### 护士下单场景

入口：工作台 @于俊超

主要流程：选择患者信息（如果没有新建） ->  选择服务 -> 选择服务时间 -> 选择服务人员

注意：如果给自己创建订单，在创建成功后需要跳转到详情页面（待支付）。

#### 新建患者

如果新建患者，则涉及新增用户的过程。

**注意用户和服务患者的区别。在我们的模型抽象中，用户可以和患者是同一个人，也可以不同。服务的患者在逻辑上是用户服务地址中的一条地址中的一项（被服务对象的姓名）。**

用户的唯一标识是电话号码（不是姓名），而下单地址中的被服务患者可以是多个。

逻辑上用户可以有多个下单地址。

新建的过程有如下两个分支：

**电话号码已经存在，即用户已经在系统中**（前提是收到验证码）
- 用户信息不对（姓名），护士不可以修改用户姓名。
- 地址信息不对（姓名，住址，电话）。已经存在的地址列表不允许修改。这里默认按最新使用地址排序。

如果有已经存在的地址信息不满足要求，则需要护士新建新的用户服务地址。

***电话号码不存在，即用户不在系统中**
这种情况下需要护士新建用户且添加一条用户的的服务地址（可以一个表单完成）。

唯一需要注意的是，用户的手机必须进行验证。两个目的，一个是后续的服务需要短信提醒患者财务信息，二是避免脏数据流入系统，互相感染。

另：这个时候患者并没有绑定微信，这里需要在患者列表中标识出来。

### 护士创建订单的状态问题

目前的状态机中如果进入待服务状态后，默认平台都是收到钱的，综合考虑，不打算改变这一现状。

护士创建的订单没有接单环节，则这里需要修改状态机。

这里要添加一个新状态，辅助下单支付待确认（状态机名称，前端名称在包装），如果确认支付成功则直接跳转到待服务状态。

跃超质疑：为什么没享受服务就要给钱。
解答：给钱只是一个动作，对于没有微信的用户来说，整个线上的内容其都无法感受到，实际操作时可以服务后再收钱。

### B端订单列表

**建议直接将护士创建的代付款的订单添加到已接单中即可。另外下单需要原生化支持。**

### 客服下单

客服下单同护士没有本质区别（多一个选择医院和科室的过程），这里建议第一期不启动，可以通过科秘系统辅助支撑。

### FAQ

#### 患者申请退款但是没有患者信息（微信）怎么办？

首先明确一个观点：退款退给谁，这里哪个微信账号支付就付款给哪个微信账号，和具体的使用人无关。

怎么实现：付款信息维护在订单信息中，直接操作对应的信息即可。

#### 患者没有微信，怎么发推送消息。

此次新添加手机短信通道，需要针对场景判断是否同时发送短信和微信推送还是只发送短信。@张跃超

### 状态机更新部分

添加了新的开始分支。

状态机更新部分如下图：
![](/media/14884469379961.jpg)


### 2月24日会议纪要

#### 选择下单患者时，如果手机号要修改的话，如何识别还是不是这个人？

答：手机号不能改。
#### 在UE中详情页添加的备注。要把备注去掉。

#### 为什么提交订单和支付要分开？

因为提交订单要填的任务量很大

#### 创建订单成功后如何保存创建订单的人的资料？

在数据库中，有一个预留字段property,里面可以存id,name,type(身份角色)，title(职称)。

#### 支付接口，要加长创建订单到付款之间的时间。

#### 如果辅助患者下单，下单后，没有微信如何推送宣教文章，自测？

如果没有，就不推送文章，不自测。

### 交互流程图

  ![流程图](/media/665.png)
  



## 详细设计

### UI稿件

Public@Youhujia/【UI设计】/1-1合肥项目/合肥项目B端/合肥－护士，客服创建订单

### 优护助手前端（APP）

工作量

- 订单服务原生化。
- 患者列表需要区分没有微信信息的用户。这里建议打上特殊TAG。部分功能需要禁用，比如聊天。
- 支持微信付款。

### 优护助手后端

#### Owl (订单中心)

[详细设计](http://wiki.office.test.youhujia.com/2017/02/11/HeiFei-2plan-owl/)

#### Midas （支付）

[详细设计](http://wiki.office.test.youhujia.com/2017/03/01/midas_payment_channel_supports_stage_2/)

#### Farmer（B端）

[详细设计](http://wiki.office.test.youhujia.com/2017/02/28/hefei_help_B_API/)
[状态跳转](http://wiki.office.test.youhujia.com/2017/03/01/HeFei_B_apiDetail/)
可以参考上面的交互逻辑图

#### Dimension（Push）

按照PRD实现即可。


## 项目管理

### 详细设计

#### 前后端研发详情

| 未开始模块 | 内容 | 负责人 |人日 | 进度  |
| --- | --- | --- | ---- |------- |
| PUSH | 完成不同场景下的PUSH逻辑开发 | 袁鑫| 1 | 已完成 |
|  | 自测 | | 1 | 已完成 |
| OWL | 服务人员辅助下单、服务人员支付、超时等接口的具体实现 | 黄英 |1 | 已完成 |
|  | 自测 |  | 1 | 已完成 |
| Farmer | 新建/更新用户接口 | 杨淑婷 | 1 | 已完成|
|  | 用户地址详情接口 |  | 1 | 已完成|
|  | 获取当前科室下的所有服务商品接口 | | 1 | 已完成|
|  | 创建订单接口 | | 0.5 | 已完成 |
|  | 获取辅助下单当前科室的所有患者接口（已有，要更改） | | 1 | 已完成 |
| 支付相关DEMO | DEMO搭建  | 于俊超 | 1  | 已完成|
|  支付支撑 | DEMO搭建  | 黄英 | 1  | 已完成 |
|  | Midas退款流程  | 黄英 | 1  | 已完成 |
|  | Owl端 | 黄英 |1| 已完成 |
| 前端 |  H5页面支撑护士待付款状态 |  董劭杰 | 1  | 已完成 |


#### APP研发详情

![](/media/14884458177357.jpg)




